…”;
}

    var button = document.querySelector("#materia button[onclick='cambio(" + subjectIndex + ")']");
    button.textContent = media.toFixed(2);
    button.style.backgroundColor = `${mediaf.style.backgroundColor}`;
    button.style.boxShadow = `0 0 10px 0 ${mediaf.style.backgroundColor}`;
    mediaf.style.boxShadow = `0 0 25px 0 ${mediaf.style.backgroundColor}`;
    comment.style.color = `${mediaf.style.backgroundColor}`;
    mediaf.textContent = media.toFixed(2);
}

function calculateNeededGrade(subjectIndex) {
    var somma_voti = 0;
    var somma_pesi = 0;
    var to6 = document.getElementById("to6-" + subjectIndex);

    for (let j = 0; j < subjects[subjectIndex].voti.length; j++) {
        somma_voti += subjects[subjectIndex].voti[j] * subjects[subjectIndex].pesi[j];
        somma_pesi += subjects[subjectIndex].pesi[j];
    }

    if (somma_pesi === 0) {
        alert("Devi inserire almeno un voto!");
        return;
    }

    var media = somma_voti / somma_pesi;

    if (media >= 6) {
        to6.textContent = "Hai già una media di 6 o superiore!";
        return;
    }

    var neededGrade = (6 * (somma_pesi + 100) - somma_voti) / 100;

    if (neededGrade > 9) {
        var remainingSommaPesi = 200; // Due esami con peso 100 ciascuno
        var requiredSum = 6 * (somma_pesi + remainingSommaPesi) - somma_voti;

        var grade1 = requiredSum / 2 / 100;
        var grade2 = requiredSum / 2 / 100;

        to6.textContent = "Per raggiungere una media di 6, devi prendere almeno " + grade1.toFixed(2) + " e " + grade2.toFixed(2) + " nei prossimi due esami.";
    } else {
        to6.textContent = "Per raggiungere una media di 6, devi prendere almeno " + neededGrade.toFixed(2) + " nel prossimo esame.";
    }
}

function mat() {
    var subjectIndex = prompt("Inserisci l'indice della materia da rimuovere:");
    subjectIndex = parseInt(subjectIndex);

    if (isNaN(subjectIndex) || subjectIndex < 0 || subjectIndex >= subjects.length) {
        alert("Indice non valido!");
        return;
    }

    subjects.splice(subjectIndex, 1);
    document.getElementById("materia").removeChild(document.getElementById("materia").children[subjectIndex]);
    document.body.removeChild(document.getElementById("content-" + subjectIndex));
    
    for (var j = subjectIndex; j < subjects.length; j++) {
        var content = document.getElementById("content-" + (j + 1));
        if (content) {
            content.id = "content-" + j;
            content.querySelectorAll("input")[0].id = "voto-" + j;
            content.querySelectorAll("input")[1].id = "peso-" + j;
            content.querySelector("ul").id = "media-" + j;
            content.querySelector(".mediaf").id = "mediaf-" + j;
            content.querySelector("p[id^='comment']").id = "comment-" + j;
            content.querySelector("p[id^='to6']").id = "to6-" + j;
            content.querySelector("button[onclick^='add']").setAttribute("onclick", "add(" + j + ")");
            content.querySelector("button[onclick^='calculateNeededGrade']").setAttribute("onclick", "calculateNeededGrade(" + j + ")");
        }

        var button = document.querySelector("#materia button[onclick^='cambio(" + (j + 1) + ")']");
        if (button) {
            button.setAttribute("onclick", "cambio(" + j + ")");
        }
    }
}

</script>
</body>
</html>